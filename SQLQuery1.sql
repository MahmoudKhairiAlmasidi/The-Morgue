CREATE DATABASE Morgue;

--Omar nagy 227750 code
CREATE TABLE STORAGE_LOCATION(
	No INT NOT NULL,
	Capacity INT,
	Temperature INT,
	Compartment INT,

	CONSTRAINT STORSAGE_PK
	PRIMARY KEY (NO)
);



--Mahmoud khairy 231625 code
CREATE TABLE EMPLOYEE(
	ID INT NOT NULL,
	Age INT,
	Birth_Date VARCHAR(20),
	Salary INT NOT NULL,
	Sex CHAR,
	City VARCHAR(10),
	Name VARCHAR(20),
	Num INT,
	Fname VARCHAR(20) NOT NULL,
	Lname VARCHAR(20) NOT NULL,

	CONSTRAINT EMPLOYEE_PK
	PRIMARY KEY (ID),
);



CREATE TABLE EMP_TEL(
	Emp_ID INT NOT NULL,
	Tel INT NOT NULL,

	CONSTRAINT EMP_PK
	PRIMARY KEY (Emp_ID, Tel),

	CONSTRAINT EMP_TEL_FK
	FOREIGN KEY (Emp_ID) REFERENCES EMPLOYEE(ID)
);



CREATE TABLE DOCTOR(
	ID INT NOT NULL,
	Doc_Type VARCHAR(20),

	CONSTRAINT DOC_PK
	PRIMARY KEY (ID),

	CONSTRAINT DOC_FK
	FOREIGN KEY (ID) REFERENCES EMPLOYEE(ID)
);



CREATE TABLE WORKER(
	ID INT NOT NULL,
	Pay_Method VARCHAR(10),

	CONSTRAINT WOK_PK
	PRIMARY KEY (ID),

	CONSTRAINT WOK_FK
	FOREIGN KEY (ID) REFERENCES EMPLOYEE(ID)
);



CREATE TABLE DECEASED(
	Case_number INT NOT NULL,
	Sex CHAR,
	Fname VARCHAR(20) NOT NULL,
	Lname VARCHAR(20) NOT NULL,
	Age INT,
	Birth_Date VARCHAR(20),
	Emp_Id INT NOT NULL,
	Storage_Num INT NOT NULL,
	Death_Certificate_Num INT NOT NULL,

	CONSTRAINT Deceased_PK
	PRIMARY KEY(Case_number),

	CONSTRAINT Emp_FK
	FOREIGN KEY(Emp_Id) REFERENCES EMPLOYEE (ID),

	CONSTRAINT Storage_PK
	FOREIGN KEY(Storage_Num) REFERENCES STORAGE_LOCATION(NO)
);


CREATE TABLE REPORT(
	Num INT NOT NULL,
	Date VARCHAR(10),

	CONSTRAINT Rep_PK
	PRIMARY KEY (Num)
);



CREATE TABLE MEDICAL_HISTORY(
	R_Num INT NOT NULL,
	Social_History VARCHAR (30),
	Case_Number INT NOT NULL,

	CONSTRAINT MH_PK
	PRIMARY KEY (R_Num),

	CONSTRAINT MH_FK
	FOREIGN KEY(Case_Number) REFERENCES DECEASED(Case_Number)
);



CREATE TABLE SURGERIES(
	R_Num INT NOT NULL,
	Past_Surgeries VARCHAR(30) NOT NULL,

	CONSTRAINT SURGERIES_PK
	PRIMARY KEY (R_Num, Past_Surgeries),

	CONSTRAINT SURGERIES_FK
	FOREIGN KEY(R_Num) REFERENCES MEDICAL_HISTORY(R_Num)
);



CREATE TABLE ALLERGIES(
	R_Num INT NOT NULL,
	Allergies VARCHAR(20) NOT NULL,

	CONSTRAINT ALLERGIES_PK
	PRIMARY KEY (R_Num, Allergies),

	CONSTRAINT ALLERGIES_FK
	FOREIGN KEY(R_Num) REFERENCES MEDICAL_HISTORY(R_Num)
);



CREATE TABLE CHRONIC_CONDITIONS(
	R_Num INT NOT NULL,
	Chronic VARCHAR(20) NOT NULL,

	CONSTRAINT CHRONIC_CONDITIONS_PK
	PRIMARY KEY (R_Num, Chronic),

	CONSTRAINT CHRONIC_CONDITIONS_FK
	FOREIGN KEY(R_Num) REFERENCES MEDICAL_HISTORY(R_Num)
);



--Mohamed kamal 238220 code
CREATE TABLE KIN (
	National_Id INT NOT NULL,
	Age INT,
	Fname VARCHAR(20) 	NOT NULL,
	Lname VARCHAR(20) 	NOT NULL,
	City VARCHAR(20),
	Relation_D VARCHAR(20),
	Num_St INT,
	Name_St VARCHAR(20),
	Case_number INT NOT NULL,
	CONSTRAINT Kin_pk 
	PRIMARY KEY (National_Id ),
	CONSTRAINT Kin_D_fk
    FOREIGN KEY (Case_number) REFERENCES DECEASED (Case_number)
);



CREATE TABLE KIN_TEL(
     National_Id INT NOT NULL,
	 Tel INT NOT NULL,
	 CONSTRAINT Kin_Tel_pk 
   	PRIMARY KEY (National_Id,Tel),
	CONSTRAINT Kin_TEL_FK
	FOREIGN KEY (National_Id) REFERENCES KIN(National_Id)
);
CREATE TABLE DONOR_REGISTRY(
    Case_Num Int not null,
	Date_D VARCHAR(20),
	Organ_Name VARCHAR(20),
	Fname VARCHAR(20),
	Lname VARCHAR(20),
	Case_number INT NOT NULL,
	CONSTRAINT Donor_pk 
	PRIMARY KEY ( Case_Num ),
	CONSTRAINT Donor_D_fk
    FOREIGN KEY (Case_number) REFERENCES DECEASED (Case_number)
);
CREATE TABLE DONOR_D_ORGAN(
     Case_Num Int not null,
	 Donated_Organ VARCHAR(20) NOT NULL,
	 CONSTRAINT Donor_Organ_pk 
	PRIMARY KEY ( Case_Num ,Donated_Organ),
	CONSTRAINT Donor_Organ_fk
    FOREIGN KEY (Case_Num) REFERENCES DONOR_REGISTRY (Case_Num)
);
CREATE TABLE GRANTED_TEL(
     Case_Num Int not null,
	 Tel INT NOT NULL,
	  CONSTRAINT GRANTED_TEL_pk 
	PRIMARY KEY ( Case_Num ,Tel),
	CONSTRAINT GRANTED_TEL_fk
    FOREIGN KEY (Case_Num) REFERENCES DONOR_REGISTRY (Case_Num)
);
CREATE TABLE DEATH_CERTIFICATE(
    Num INT NOT NULL,
	Heath_Office VARCHAR(20),
	Residence VARCHAR(20),
	Marital_Status VARCHAR(20),
	CONSTRAINT DEATH_CERTIFICATE_pk 
	PRIMARY KEY (Num)
);


--Mahmoud Khairy Alter--

ALTER TABLE DECEASED
ALTER COLUMN Birth_Date VARCHAR(10);

ALTER TABLE EMPLOYEE
ALTER COLUMN Birth_Date VARCHAR(10);

ALTER TABLE DOCTOR
ALTER COLUMN Doc_Type VARCHAR(30);


--Mohamed Kamal Alter--

ALTER TABLE KIN
ADD Zip_Code INT;

ALTER TABLE KIN
ALTER COLUMN Name_St VARCHAR(30);

ALTER TABLE DONOR_REGISTRY
ALTER COLUMN Organ_Name VARCHAR(30);


-- Omar nagy 227750 values --
-- Storage Location value --
INSERT INTO STORAGE_LOCATION
VALUES (1, 5, 10, 1);
INSERT INTO STORAGE_LOCATION
VALUES (2, 5, 10, 1);
INSERT INTO STORAGE_LOCATION
VALUES (3, 5, 10, 1);
INSERT INTO STORAGE_LOCATION
VALUES (4, 5, 10, 2);
INSERT INTO STORAGE_LOCATION
VALUES (5, 5, 10, 2);
INSERT INTO STORAGE_LOCATION
VALUES (6, 5, 10, 2);



-- Mahmoud Khairy 231625 values --

--EMPLOYEE VALUE--
INSERT INTO EMPLOYEE
VALUES (1, 43, '12/4/1980', 7500,'M', 'Maddi', 'Hamdy Morad', 112, 'Tamer', 'Mohasen');
INSERT INTO EMPLOYEE
VALUES (2, 33, '12/4/1989', 5000, 'M','Shorouk', 'Magdy Aldeeb', 43, 'Ahmed', 'Samah');
INSERT INTO EMPLOYEE
VALUES (3, 26, '12/4/1996', 7500, 'F','Nasr', 'Hasan Mamoum', 12, 'Hanan', 'Amir');
INSERT INTO EMPLOYEE
VALUES (4, 51, '12/4/1970', 13700, 'M', 'Shoubra', 'Khalil', 134, 'Wagdy', 'Hamdy');
INSERT INTO EMPLOYEE
VALUES (5, 47, '12/4/1977', 10000, 'M', 'Shorouk', 'Mahmoud Tawfik', 123, 'Mohamed', 'Mahmoud');
INSERT INTO EMPLOYEE
VALUES (6, 38, '12/4/1986', 17300, 'M', 'Moukatam', 'Makram abied', 152, 'Amir', 'Youseef');
INSERT INTO EMPLOYEE
VALUES (7, 65, '12/4/1963', 6700, 'M', 'Moukatam', 'Sayed hamad', 196, 'Ahmed', 'Khaled');
INSERT INTO EMPLOYEE
VALUES (8, 48, '12/4/1980', 16500, 'F', 'Nasr', 'Hamouda', 122, 'Nouha', 'Mostafa');


--EMP_TEL VALUE--
INSERT INTO EMP_TEL
VALUES (2, 0103391334);
INSERT INTO EMP_TEL
VALUES (2, 0113441364);
INSERT INTO EMP_TEL
VALUES (1, 0125339133);
INSERT INTO EMP_TEL
VALUES (1, 0153363534);
INSERT INTO EMP_TEL
VALUES (4, 0103980334);
INSERT INTO EMP_TEL
VALUES (4, 0123084314);

--DOCTOR VALUE--
INSERT INTO DOCTOR
VALUES (2, 'Anatomy');
INSERT INTO DOCTOR
VALUES (7, 'Anesthesia');
INSERT INTO DOCTOR
VALUES (5, 'Analysis');
INSERT INTO DOCTOR
VALUES (3, 'Anatomy');
INSERT INTO DOCTOR
VALUES (6, 'Anesthesia');

--WORKER VALUE--
INSERT INTO WORKER
VALUES(1, 'Daily');
INSERT INTO WORKER
VALUES(4, 'Monthly');
INSERT INTO WORKER
VALUES(8, 'Monthly');


--DECEASED VALUE--
INSERT INTO DECEASED
VALUES (1, 'M', 'Ahmed', 'Abdelwahab', 36, '13/5/1974', 1, 1,1);
INSERT INTO DECEASED
VALUES (2, 'F', 'Sara', 'Ahmed', 53, '11/2/1963', 2, 1,2);
INSERT INTO DECEASED
VALUES (3, 'M', 'Tamer', 'Magdy', 76, '4/5/1950', 1, 1,3);
INSERT INTO DECEASED
VALUES (4, 'F', 'Amiera', 'Wael', 22, '3/10/2001', 3, 1,4);
INSERT INTO DECEASED
VALUES (5, 'M', 'Omar', 'Tamer', 9, '20/7/2014', 4, 2,5);
INSERT INTO DECEASED
VALUES (6, 'M', 'Mohamed', 'Sayed', 33, '23/9/1991', 1, 2,6);
INSERT INTO DECEASED
VALUES (7, 'M', 'Ahmed', 'Wahed', 40, '12/10/1986', 2, 2,7);
INSERT INTO DECEASED
VALUES (8, 'F', 'Nour', 'Mohamed', 47, '15/11/1973', 4, 3,8);


--REPORT VALUE--
INSERT INTO REPORT
VALUES (1, '2/3/2020');
INSERT INTO REPORT
VALUES (2, '30/10/2020');
INSERT INTO REPORT
VALUES (3, '2/7/2021');
INSERT INTO REPORT
VALUES (4, '12/4/2021');
INSERT INTO REPORT
VALUES (5, '11/11/2020');
INSERT INTO REPORT
VALUES (6, '8/9/2020');
INSERT INTO REPORT
VALUES (7, '17/8/2021');

--MEDICAL_HISTORY VALUE--
INSERT INTO MEDICAL_HISTORY
VALUES (1, 'Married', 1);
INSERT INTO MEDICAL_HISTORY
VALUES (2, 'Married', 2);
INSERT INTO MEDICAL_HISTORY
VALUES (3, 'Celibate', 3);
INSERT INTO MEDICAL_HISTORY
VALUES (4, 'Celibate', 4);
INSERT INTO MEDICAL_HISTORY
VALUES (5, 'Married', 5);
INSERT INTO MEDICAL_HISTORY
VALUES (6, 'Celibate', 6);
INSERT INTO MEDICAL_HISTORY
VALUES (7, 'Married', 7);


--SURGERIES VALUES--
INSERT INTO SURGERIES
VALUES (2, 'Bariatric Surgery');
INSERT INTO SURGERIES
VALUES (2, 'Colon & Rectal Surgery');
INSERT INTO SURGERIES
VALUES (2, 'Endocrine Surgery');
INSERT INTO SURGERIES
VALUES (1, 'Bariatric Surgery');
INSERT INTO SURGERIES
VALUES (1, 'Head & Neck Surgery');
INSERT INTO SURGERIES
VALUES (1, 'Neurosurgery');
INSERT INTO SURGERIES
VALUES (5, 'Thoracic Surgery');
INSERT INTO SURGERIES
VALUES (5, 'Vascular Surgery');

--ALLERGIES VALUES--
INSERT INTO ALLERGIES
VALUES (3, 'Anaphylaxis');
INSERT INTO ALLERGIES
VALUES (3, 'Sinusitis');
INSERT INTO ALLERGIES
VALUES (4, 'Asthma');
INSERT INTO ALLERGIES
VALUES (5, 'Drug Allergy');
INSERT INTO ALLERGIES
VALUES (4, 'Drug Allergy');
INSERT INTO ALLERGIES
VALUES (5, 'Rhinitis');

--CHRONIC_CONDITION VALUES--
INSERT INTO CHRONIC_CONDITIONS
VALUES (1, 'Heart disease');
INSERT INTO CHRONIC_CONDITIONS
VALUES (1, 'Cancer');
INSERT INTO CHRONIC_CONDITIONS
VALUES (2, 'Cancer');
INSERT INTO CHRONIC_CONDITIONS
VALUES (2, 'Depression');
INSERT INTO CHRONIC_CONDITIONS
VALUES (1, 'Diabetes');



--Mohamed Kamal 238220 values--
--KIN VALUE--
 INSERT INTO KIN
VALUES (23300291, 34, 'Ali', 'Mohamed', 'Cairo', 'Dad', 21, 'Salah Salem',1,046);
 INSERT INTO KIN
VALUES (23300342, 42, 'Ayman', 'Mahmoud', 'Alex', 'Son', 23, 'Abu Qear',2,044);
 INSERT INTO KIN
VALUES (23300273, 52, 'yasser', 'Abdelwahab','Matrouh' ,'Dad', 10, 'Eltahrer',3,049);
 INSERT INTO KIN
VALUES (23300453, 37, 'Mazen', 'Ahmed', 'Cairo', 'Couisn', 34, 'Elwaha',4,048);
 INSERT INTO KIN
VALUES (23310291, 45, 'Mostafa', 'Saad', 'Aswan', 'Dad', 20, 'Elsadat',5,047);
 INSERT INTO KIN
VALUES (23300352, 33, 'Reda', 'Sayed', 'Alex', 'Couisn', 13, 'Souter',6,043);
 INSERT INTO KIN
VALUES (23300634, 53, 'Marwan', 'Bakr', 'Aswan', 'Couisn', 19, 'Al Fanadek',7,042);
 INSERT INTO KIN
VALUES (23300554, 56, 'Kamal', 'Osama', 'Matrouh', 'Dad', 28, 'El Naser',8,041);
     
--KIN_TEL VALUE--

 INSERT INTO KIN_TEL
VALUES (23300291, 01015675500);
 INSERT INTO KIN_TEL
VALUES (23300291, 01090895451);
 INSERT INTO KIN_TEL
VALUES (23300342, 01090895217);
 INSERT INTO KIN_TEL
VALUES (23300342, 01096229639);
 INSERT INTO KIN_TEL
VALUES (23300273, 01012526738);
 INSERT INTO KIN_TEL
VALUES (23300273, 01029873511);
 INSERT INTO KIN_TEL
VALUES (23300453, 01002973832);
 INSERT INTO KIN_TEL
VALUES (23300453, 01000372839);
 INSERT INTO KIN_TEL
VALUES (23310291, 01238497323);
 INSERT INTO KIN_TEL
VALUES (23310291, 01192836482);
 INSERT INTO KIN_TEL
VALUES (23300352, 01003829748);
 INSERT INTO KIN_TEL
VALUES (23300352, 01138738212);
 INSERT INTO KIN_TEL
VALUES (23300634, 01293740201);
 INSERT INTO KIN_TEL
VALUES (23300634, 01273849737);
 INSERT INTO KIN_TEL
VALUES (23300554, 01033938293);
INSERT INTO KIN_TEL
VALUES (23300554, 01000927384);

--DONOR_REGISTRY VALUE--
INSERT INTO DONOR_REGISTRY
VALUES (20, '11/5/2023', 'heart', 'Mohamed', 'Ali',1);
INSERT INTO DONOR_REGISTRY
VALUES (21, '15/4/2023', 'pancreas', 'Sayed', 'Rady',2);
INSERT INTO DONOR_REGISTRY
VALUES (22, '12/7/2023', 'kidneys', 'Mohamed', 'Mostafa', 3);
INSERT INTO DONOR_REGISTRY
VALUES (23, '02/4/2023', 'liver', 'Gaber', 'Karm', 4);
INSERT INTO DONOR_REGISTRY
VALUES (24, '21/4/2023', 'liver', 'Mohab', 'Farse', 5);
INSERT INTO DONOR_REGISTRY
VALUES (25, '10/8/2023', 'liver', 'Ahmed', 'Fayez', 6);
INSERT INTO DONOR_REGISTRY
VALUES (26, '04/1/2023', 'lungs', 'Ramy', 'Ali', 7);
INSERT INTO DONOR_REGISTRY
VALUES (27, '14/3/2023', 'liver', 'Saad', 'Rashed', 8);

--DONOR_D_ORGAN VALUE--
INSERT INTO DONOR_D_ORGAN 
VALUES (20, 'liver');
INSERT INTO DONOR_D_ORGAN 
VALUES (20, 'lungs');
INSERT INTO DONOR_D_ORGAN 
VALUES (21, 'heart');
INSERT INTO DONOR_D_ORGAN 
VALUES (21, 'pancreas');
INSERT INTO DONOR_D_ORGAN 
VALUES (21, 'kidneys');
INSERT INTO DONOR_D_ORGAN 
VALUES (22, 'liver');
INSERT INTO DONOR_D_ORGAN 
VALUES (22, 'kidneys');
INSERT INTO DONOR_D_ORGAN 
VALUES (23, 'heart');
INSERT INTO DONOR_D_ORGAN 
VALUES (23, 'liver');
INSERT INTO DONOR_D_ORGAN 
VALUES (24, 'liver');
INSERT INTO DONOR_D_ORGAN 
VALUES (24, 'kidneys');
INSERT INTO DONOR_D_ORGAN 
VALUES (25, 'heart');
INSERT INTO DONOR_D_ORGAN 
VALUES (25, 'lungs');
INSERT INTO DONOR_D_ORGAN 
VALUES (26, 'lungs');
INSERT INTO DONOR_D_ORGAN 
VALUES (26, 'kidneys');
INSERT INTO DONOR_D_ORGAN 
VALUES (27, 'lungs');
INSERT INTO DONOR_D_ORGAN 
VALUES (27, 'heart');
INSERT INTO DONOR_D_ORGAN 
VALUES (27, 'liver');


--GRANTED_TEL VALUE--
INSERT INTO GRANTED_TEL
VALUES (20, 01090895452);
INSERT INTO GRANTED_TEL
VALUES (20, 01004324543);
INSERT INTO GRANTED_TEL
VALUES (21, 01035467557);
INSERT INTO GRANTED_TEL
VALUES (21, 01284839383);
INSERT INTO GRANTED_TEL
VALUES (22, 01128394738);
INSERT INTO GRANTED_TEL
VALUES (22, 01274738634);
INSERT INTO GRANTED_TEL
VALUES (23, 01038392973);
INSERT INTO GRANTED_TEL
VALUES (23, 01003483934);
INSERT INTO GRANTED_TEL
VALUES (24, 01032648948);
INSERT INTO GRANTED_TEL
VALUES (24, 01009309273);
INSERT INTO GRANTED_TEL
VALUES (25, 01261727833);
INSERT INTO GRANTED_TEL
VALUES (25, 01163624262);
INSERT INTO GRANTED_TEL
VALUES (26, 01142346828);
INSERT INTO GRANTED_TEL
VALUES (26, 01246769238);
INSERT INTO GRANTED_TEL
VALUES (27, 01233342564);
INSERT INTO GRANTED_TEL
VALUES (27, 01038262256);


--DEATH_CERTIFICATE VALUE--
INSERT INTO DEATH_CERTIFICATE
VALUES (1, 'Maadi','Cairo','Single');
INSERT INTO DEATH_CERTIFICATE
VALUES (2, 'bolaa eldakror','Alex','Married');
INSERT INTO DEATH_CERTIFICATE
VALUES (3, 'Madinty','Marsa Matrouh','Divorced');
INSERT INTO DEATH_CERTIFICATE
VALUES (4, 'Zamalk','Cairo','Cohabiting');
INSERT INTO DEATH_CERTIFICATE
VALUES (5, 'Zamalk','Cairo','Single');
INSERT INTO DEATH_CERTIFICATE
VALUES (6, 'Nasr City','Alex','Single');
INSERT INTO DEATH_CERTIFICATE
VALUES (7, 'Nasr City','Marsa Matrouh','Married');



--Mahmoud Khairy 231625 Query--
--Simple Query--
SELECT * 
FROM DECEASED;

SELECT Fname + ' ' + Lname AS 'FULL NAME OF THE DECEASED'
FROM DECEASED;

SELECT Fname + ' ' + Lname AS 'FULL NAME OF THE EMPLOYEE'
FROM EMPLOYEE;

SELECT Fname + ' ' + Lname AS 'FULL NAME OF THE EMPLOYEE'
FROM EMPLOYEE
ORDER BY Salary;

SELECT ID AS 'DOCTOR ID', Doc_Type AS 'DOCTOR TYPE'
FROM DOCTOR;


-- Aggregate Functions --
SELECT COUNT(*) AS 'Total number of employee'
FROM EMPLOYEE;

SELECT SUM (Salary) AS ' SUM OF SALARY', AVG (Salary) AS ' AVERAGE OF SALARY', MAX (Salary) AS ' MAXIMUM OF SALARY'
, MIN (Salary) AS 'MINIMUM OF SALARY'
FROM EMPLOYEE;


--Inner Join--
SELECT Fname + ' ' + Lname AS 'Full name of doctor' , Doc_Type AS 'Doctor type'
FROM EMPLOYEE, DOCTOR
WHERE EMPLOYEE.ID = DOCTOR.ID;

SELECT Fname + ' ' + Lname AS 'Full name of worker' , Pay_Method AS 'Pay Method'
FROM EMPLOYEE, WORKER
WHERE EMPLOYEE.ID = WORKER.ID;


SELECT DISTINCT Fname + ' ' + Lname AS 'FULL NAME OF THE DECEASED', Storage_Num AS 'STORAGE NUMBER OF THE DECEASED'
, Emp_Id AS 'A DOCTOR WHO PERFORMS AN AUTOPSY'
FROM DECEASED, STORAGE_LOCATION, DOCTOR
WHERE DECEASED.Emp_Id = DOCTOR.ID;


SELECT DISTINCT Fname +' ' + Lname AS ' Full name of the deseased' , Past_Surgeries AS 'Past Surgeries'
FROM DECEASED, SURGERIES, MEDICAL_HISTORY
WHERE DECEASED.Case_number = MEDICAL_HISTORY.Case_Number;


SELECT DISTINCT Fname +' ' + Lname AS ' Full name of the deseased' , Chronic  AS 'Chronic'
FROM DECEASED, CHRONIC_CONDITIONS, MEDICAL_HISTORY
WHERE DECEASED.Case_number = MEDICAL_HISTORY.Case_Number;


SELECT DISTINCT Fname +' ' + Lname AS ' Full name of the deseased' , ALLERGIES  AS 'Allergies'
FROM DECEASED, ALLERGIES, MEDICAL_HISTORY
WHERE DECEASED.Case_number = MEDICAL_HISTORY.Case_Number;


SELECT City, COUNT(*)
FROM EMPLOYEE
GROUP BY City;


SELECT Age, COUNT(*)
FROM DECEASED
GROUP BY Age
HAVING Age > 30;


SELECT Fname + ' ' + Lname AS 'DOCTOR FULL NAME'
FROM EMPLOYEE JOIN DOCTOR
ON EMPLOYEE.ID = DOCTOR.ID;


SELECT Fname + ' ' + Lname AS 'DECEASED FULL NAME', Social_History AS ' SOCIAL HISTORY'
FROM DECEASED RIGHT OUTER JOIN MEDICAL_HISTORY
ON DECEASED.Case_number = MEDICAL_HISTORY.Case_Number;


SELECT Fname + ' ' + Lname AS 'DECEASED FULL NAME', Num AS 'CASE NUMBER'
FROM DECEASED LEFT OUTER JOIN DEATH_CERTIFICATE
ON DECEASED.Case_number = DEATH_CERTIFICATE.Num;


--Nested--
SELECT Fname, Case_number, Sex
FROM DECEASED D
WHERE D.Case_number IN ( SELECT M.Case_Number
FROM MEDICAL_HISTORY M);


SELECT Fname + ' ' + Lname AS 'Deceased Full Name'
FROM DECEASED JOIN DEATH_CERTIFICATE
ON Num = Death_Certificate_Num
WHERE Num IN ( SELECT Num
FROM REPORT WHERE Num = '7');


--Omar Nagy 227750 Query--

SELECT *
FROM STORAGE_LOCATION;

SELECT *
FROM STORAGE_LOCATION
WHERE Temperature > 10;

SELECT COUNT(*) AS 'Total Storage Locations'
FROM STORAGE_LOCATION;

SELECT *
FROM STORAGE_LOCATION
WHERE Capacity = (SELECT MAX(Capacity) FROM STORAGE_LOCATION);

SELECT *
FROM STORAGE_LOCATION
WHERE Compartment = 2;

SELECT *
FROM STORAGE_LOCATION
WHERE Capacity < 5;


--Mohamed Kamal Query--
SELECT *
FROM KIN;

SELECT *
FROM DEATH_CERTIFICATE
WHERE Marital_Status='Single';

SELECT Fname AS 'First Name',Lname AS 'Last Name'
FROM KIN;

SELECT Case_Num AS 'Case Number' , Organ_Name AS 'Organ name',Fname AS 'First name',Lname AS 'Last name'
FROM DONOR_REGISTRY
WHERE Organ_Name IN('liver','kidneys');

SELECT Case_Num AS 'Case Number' , Organ_Name AS 'Organ name',Fname AS 'First name',Lname AS 'Last name'
FROM DONOR_REGISTRY
WHERE Organ_Name NOT IN('liver','kidneys');

SELECT Relation_D AS 'Relation with Deceased',Fname+' '+Lname AS'Full Name'
FROM KIN
WHERE Relation_D='Dad' AND Fname='Ali'  ;

SELECT COUNT(*)AS'Total Number of D_C'
FROM DEATH_CERTIFICATE;

SELECT Heath_Office,COUNT(*) AS 'Total'
FROM DEATH_CERTIFICATE
GROUP BY  Heath_Office;

SELECT AVG(Age)'AVG Age',MIN(Age)'MIN Age',MAX(Age)'MAX Age',City,COUNT(*)'Total'
FROM KIN
GROUP BY City
HAVING MIN(Age)>30;


SELECT DECEASED.Fname +' '+DECEASED.Lname AS'Full Name',Organ_Name AS'Organ Name'
FROM DECEASED JOIN DONOR_REGISTRY
ON DECEASED.Case_number=DONOR_REGISTRY.Case_number
WHERE Organ_Name='liver';

 SELECT DECEASED.Fname +' '+DECEASED.Lname AS'Full Name',Organ_Name AS'Organ Name'
FROM DECEASED LEFT OUTER JOIN DONOR_REGISTRY
ON DECEASED.Case_number=DONOR_REGISTRY.Case_Num;
 


SELECT DECEASED.Fname +' '+DECEASED.Lname AS'Full Name',Organ_Name AS'Organ Name'
FROM DECEASED RIGHT OUTER JOIN DONOR_REGISTRY
ON DECEASED.Case_number=DONOR_REGISTRY.Case_Num;


SELECT DECEASED.Fname +' '+DECEASED.Lname AS'Full Name',Organ_Name AS'Organ Name'
FROM DECEASED FULL OUTER JOIN DONOR_REGISTRY
ON DECEASED.Case_number=DONOR_REGISTRY.Case_Num;

SELECT Fname+' '+Lname AS'Full Name',Age
FROM KIN
WHERE Age=(SELECT MAX(Age)
FROM KIN);

SELECT Fname+' '+Lname AS'Full Name',Age
FROM KIN
WHERE Age>(SELECT AVG(Age)
FROM KIN);

SELECT Fname+' '+Lname AS'Full Name',Sex,Heath_Office
FROM DECEASED JOIN DEATH_CERTIFICATE
ON  DECEASED.Death_Certificate_Num=DEATH_CERTIFICATE.Num
WHERE Heath_Office IN(SELECT Heath_Office
FROM DECEASED JOIN DEATH_CERTIFICATE
ON  DECEASED.Death_Certificate_Num=DEATH_CERTIFICATE.Num 
WHERE Sex='M');